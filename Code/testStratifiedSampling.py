import numpy as np
import pandas as pd
from sklearn.model_selection import train_test_split

# Create a DataFrame from the given data snippet
data = {
    'source': [0, 1, 2, 3, 4, 0, 1, 2, 3, 4, 0, 1, 2, 3, 4],
    'num1': [8, 3741, 42140, 1132, 10865, 7, 1510, 13854, 7677, 3835, 3, 246, 9026, 4875, 9435],
    'num2': [9, 3747, 168560, 1137, 54325, 2, 1514, 124686, 7682, 19175, 8, 252, 63182, 4880, 47175],
    'num3': [2, 3755, 168560, 1142, 271625, 1, 1517, 872802, 7687, 95875, 8, 260, 63182, 4885, 235875],
    'num4': [1, 3761, 1517040, 1147, 1358125, 4, 1525, 872802, 7692, 479375, 7, 261, 126364, 4890, 1179375],
    'num5': [7, 3769, 9102240, 1152, 6790625, 3, 1533, 6982416, 7697, 2396875, 9, 262, 758184, 4895, 5896875],
    'num6': [1, 3777, 81920160, 1157, 33953125, 2, 1537, 62841744, 7702, 11984375, 6, 268, 3790920, 4900, 29484375],
    'num7': [6, 3781, 737281440, 1162, 169765625, 2, 1541, 439892208, 7707, 59921875, 8, 275, 22745520, 4905, 147421875],
    'num8': [2.0, 3789.0, 3686407200.0, 1167.0, 848828125.0, 2.0, 1548.0, 2199461040.0, 7712.0, 299609375.0, 8.0, 279.0, 90982080.0, 4910.0, 737109375.0],
    'num9': [5.0, 3791.0, 33177664800.0, 1172.0, 4244140625.0, 9.0, 1550.0, 8797844160.0, 7717.0, 1498046875.0, 5.0, 281.0, 454910400.0, 4915.0, 3685546875.0],
    'num10': [8.0, 3795.0, 66355329600.0, 1177.0, 21220703125.0, 7.0, 1555.0, 52787064960.0, 7722.0, 7490234375.0, 8.0, 282.0, 3639283200.0, 4920.0, 18427734375.0]
}
df = pd.DataFrame(data)

# Stratified sampling to maintain class distribution for 50% of the data
df_sample = df.groupby('source', group_keys=False).apply(lambda x: x.sample(frac=0.5, random_state=42)).reset_index(drop=True).reset_index(drop=True)

# Verify the stratified sampling
print(df_sample['source'].value_counts(normalize=True))
print(df['source'].value_counts(normalize=True))

# Display the sampled DataFrame
print(df_sample)
